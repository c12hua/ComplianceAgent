# PII 初步检测模块（1人）

## 功能1：大模型识别

**输入参数**：结构化文本（读取预处理模块的结构化文本，路径为../../backend/knowledge/text）

**输出参数**：json格式的个人信息（存入数据库ComplianceWizard下的person_information表中）

**时间**：8.20-8.21

**功能详述**：根据结构化的文本，使用大模型进行识别，将识别结果保存为json，以下方为例（如果有更好的结构可以自行设计，需要与下一步骤的接口人沟通一致）

 **举例**:
 

|   结构话文本           | json文本 | 
|--------------|----------|
| ['患者', '张某', '，', '男', '，', '45', '岁', '，', '主诉', '头痛', '3', '天']<br>['曾', '诊断', '为', '高血压', '，', '现', '服用', '降压药']<br>['医保卡号', '为', '12345678', '，', '进行', 'MRI', '检查', '并', '开具', '电子', '处方']| { <br> "text": "患者张某，男，45岁，主诉头痛3天。曾诊断为高血压，现服用降压药。医保卡号为12345678，进行MRI检查并开具电子处方。",<br>"entities": [<br>{"entity": "张某", "type": "姓名"},<br> {"entity": "头痛", "type": "症状"}, <br>{"entity": "高血压", "type": "疾病"},<br> {"entity": "降压药", "type": "药物"},<br>{"entity": "医保卡号", "type": "支付信息"},<br>  {"entity": "MRI检查", "type": "检查项目"},  <br>  {"entity": "电子处方", "type": "处方"}<br> ]<br>} | 


## 功能2：数据库建立

**功能详述**：创建一个名为ComplianceWizard的数据库，根据需要建立自己的表（推荐使用数据库 postgres or MySQL）

**时间**：8.21-8.22

本功能独立为方便存储数据，无需对接

## 辅助功能：PII数据统计

**输入参数**：100个样例结构化文本，100个预测识别的json文本

**输出参数**：识别准确率、精准率、召回率、F1值

**时间**：8.23-8.31

**功能详述**：用于统计PII识别的结果，详细见下方解释，为论文实验做准备

### 二分类混淆矩阵

|              | 预测识别为个人信息 | 预测识别为一般信息 |
|--------------|----------|----------|
| **实际识别为个人信息** | TP       |   FN     |
| **实际识别为一般信息** | FP       | TN       |

---

### 常用指标计算公式

1. **准确率（Accuracy）**  
   Accuracy = (TP + TN) / (TP + TN + FP + FN)

2. **精确率（Precision）**  
   Precision = TP / (TP + FP)  
   含义：预测为正的样本中，有多少是真的正样本。

3. **召回率（Recall / Sensitivity）**  
   Recall = TP / (TP + FN)  
   含义：所有真实正样本中，有多少被预测对了。

4. **F1 值（F1-Score）**  
   F1 = 2 × (Precision × Recall) / (Precision + Recall)  
   含义：Precision 与 Recall 的调和平均值。

---

### 备注
- **TP**（True Positive）：预测为正，且实际为正  
- **FP**（False Positive）：预测为正，但实际为负  
- **TN**（True Negative）：预测为负，且实际为负  
- **FN**（False Negative）：预测为负，但实际为正


