# 病例文本输入+预处理模块（1人、罗进选）

## 功能1：文本清洗与标准化

**时间**：8.18-8.22

**输入参数**：[病例文本](./Sample.md)

**功能入口**：view.py 下的PiiDetectView

**功能详述**：将病例中的标点符号删除，并统一格式

**举例**：

| 原始文本   | 标准化文本 |
|--------|-----------|
| 患者张某，男，45岁，主诉头痛3天。曾诊断为高血压，现服用降压药。医保卡号为12345678，进行MRI检查并开具电子处方。 | \['患者张某，男，45岁，主诉头痛3天', '曾诊断为高血压，现服用降压药', '医保卡号为12345678，进行MRI检查并开具电子处方'\]     |

**输出参数**：标准化文本


## 功能2：分句+分词

**时间**：8.22-8.25

**输入参数**：标准化文本

**功能详述**：将标准化的文本按照中文能够理解的方式进行分词，拆分成语义片段和和词语

**使用工具**：spaCy + LTP

**举例**：

| 原始文本   | 标准化文本 |
|--------|-----------|
|\['患者张某，男，45岁，主诉头痛3天', '曾诊断为高血压，现服用降压药', '医保卡号为12345678，进行MRI检查并开具电子处方'\]  | \['患者', '张某', '，', '男', '，', '45', '岁', '，', '主诉', '头痛', '3', '天'\]\['曾', '诊断', '为', '高血压', '，', '现', '服用', '降压药'\]\['医保卡号', '为', '12345678', '，', '进行', 'MRI', '检查', '并', '开具', '电子', '处方'\] |

**输出参数**：结构化文本，命令方式以文件名+时间戳的形式存储

**输出路径**：[病例文本_时间戳](./../../backend/knowledge_base/text/)，文件放在/backend/knowledge_base/text/ 下，如果不存在就创建



## 辅助功能：自动化测试实验

**输入参数**：100个病例样本

**输出参数**：统计信息

**时间**：8.25-8.31

**功能详述**：构造100个样本，并且人工进行了分词作为预测样本，使用100个样本经过程序的预处理和分词后与人工分词进行对比，统计结果，具体统计数据如下：



### 二分类混淆矩阵

|              | 预测为正 | 预测为负 |
|--------------|----------|----------|
| **实际为正** | TP       | FN       |
| **实际为负** | FP       | TN       |

---

### 常用指标计算公式

1. **准确率（Accuracy）**  
   Accuracy = (TP + TN) / (TP + TN + FP + FN)

2. **精确率（Precision）**  
  Precision = TP / (TP + FP)  
   - 含义：预测为正的样本中，有多少是真的正样本。

3. **召回率（Recall / Sensitivity）**  
  Recall = TP / (TP + FN)  
   - 含义：所有真实正样本中，有多少被预测对了。

4. **F1 值（F1-Score）**  
   F1 = 2 × (Precision × Recall) / (Precision + Recall)  
   - 含义：Precision 与 Recall 的调和平均值。





---


### 备注
- **TP**（True Positive）：预测为正，且实际为正  
- **FP**（False Positive）：预测为正，但实际为负  
- **TN**（True Negative）：预测为负，且实际为负  
- **FN**（False Negative）：预测为负，但实际为正













